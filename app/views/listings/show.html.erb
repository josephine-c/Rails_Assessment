<p id="notice"><%= notice %></p>

<%= link_to 'Edit', edit_listing_path(@listing) %> |
<%= link_to 'Back', listings_path %>

<h1>
    <%="#{@listing.shop.name}"%>
</h1>

# Create a list of all items in the listing 
## Need access to all items that match listing id through link table.


<button id="stripePayment">Pay Deposit: $<%=number_with_precision(@listing.total/100.0, precision: 2)%></button>


<script>
document.getElementById("stripePayment").addEventListener("click", function() {
  var stripe = Stripe('<%= Rails.application.credentials.dig(:stripe, :public)%>');

  stripe.redirectToCheckout({
      sessionId: '<%= @stripe_session_id%>',
    }).then(function (result) {
      // If `redirectToCheckout` fails due to a browser or network
      // error, display the localized error message to your customer
      // using `result.error.message`.
    });
});
</script>